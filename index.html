<html>
    <head>
        <title>Guitar.js</title>
        <script src="rfielding.github.io"></script>
        <link rel="stylesheet" type="text/css" href="guitar.css"/>
        <style>
          body {
              font-family: Arial;    
          }
        </style>
    </head>
    <body onload='doinit()'>
    
        <div class="sheet">
            <h2>Contact</h2>
            <div class=subsections>
                <ul>
                    <li>Rob Fielding &lt;rob.fielding@gmail.com&gt;
                    <li><a href="resume.pdf">My Resume</a>
                    <li><a href="http://www.youtube.com/rrr00bb">YouTube</a>
		    <!-- <li><a href="http://rfieldin.appspot.com">Appspot - iOS app specific links (some microtonalism)</a> wow, gone now. -->
                    <li><a href="http://rrr00bb.blogspot.com">Random blogposts, mostly iOS, MIDI, and programming</a>
                    <li><a href="https://github.com/rfielding/rfielding.github.com">The Source Code for this site, including the guitar diagram generation</a>
                </ul>
            </div>
        </div>

	<div class="sheet">
	    <h2>My Arduino MIDI Projects</h2>
		<div class=subsections>
                <div style="float:left; border:20px">
	      		<iframe width="420" height="315" src="https://www.youtube.com/embed/0Pu7oBciNJU" frameborder="0" allowfullscreen></iframe>
		</div>
	    This is a project using an Arduino UNO board (AVR chip, 2k RAM, etc.) to proxy the MIDI
	    protocol to change the capabilities of MIDI controllers like keyboards, in a format that is
	    similar to guitar pedal stompbox devices.
	    The point is in doing these C++ projects that run under very tight size and real-time constraints.

	    <p>

		    <img width=250 height=250 src=http://cdn2.bigcommerce.com/n-zfvgw8/juoflv6a/products/226/images/433/MIDI_shield_1__25148.1381483734.1280.1280.jpg?c=2>
		    <img width=250 height=250 src=http://www.robotshop.com/media/files/images2/rb-ard-34-1.jpg>
	    <div style="border:30px; float:clear">
	    This pedal takes all incoming MIDI messages and:
	    <ul>
		    <li>Assume they are all on the same channel
		    <li>Remember which key last went down
		    <li>Do a virtual octave switch up or down depending on which will make the interval jump shorter
		    <li>Take the bottom half of the keyboard below middle-C and reserve it for completely different relative jump functionality
		    <li>This is relatively straightforward Serial Port code, except you cannot block for IO on Arduino, so
		    it ends up being a tricky state machine to get everything right.
		    <li> <a href=https://github.com/rfielding/octaveRounder>Source code on github</a>
	    </ul>
            </div>
         </div>
    	</div>

	<div class="sheet">
	<h2>iOS apps I wrote</h2>
	<div class="subsections">
	    When the iPad first came out, I was doing serious iOS music application development.

	    <ul>
		    <li>Mugician (source still on my github account in Mugician repo - dozens of clones of it still exist in the app store)
		    <li>Geo Synthesizer (a commercial venture with Dream Theater's keyboardist Jordan Rudess, related to upcoming GeoShred app that Wizdom/MoForte is working on at the moment)
		    <li>Cantor / AlephOne (a simplified app similar to Geo - source in github under the repo name AlephOne)
	    </ul>
            <iframe width="420" height="315" src="http://www.youtube.com/embed/pnKXLfWgSCk" frameborder="10"></iframe>
	    <iframe width="560" height="315" src="https://www.youtube.com/embed/rikE-2v5Icg" frameborder="10"></iframe>
            When the iPad first came out, there was no MIDI support available, so Mugician had its own sound engine.
	    By contrast, the app featured here was originally written to use MIDI internally, and was originally targeted
	    to only pair with the app ThumbJam, due to the extreme re-interpretation of the MIDI protocol required to
	    do fretless polyphonic instruments correctly.
	    <p>
	    <iframe width="420" height="315" src="https://www.youtube.com/embed/4gPo3HRDWKU" frameborder="10"></iframe>
	    Into the first year of iPad, the typical iOS music app had far too much latency to be a viable music instrument
	    (music instruments must be in the 10ms of latency range... 1/100 of 1 second touch to audio response; at a time
	    when 100ms was the norm.).
	    Mugician and Geo Synthesizer were widely regarded as some of only a handful of iOS instruments which could be played
	    at the actual speed that real musicians could throw at it.
	    (Much of this was achieved by avoiding UIKit in favor of OpenGLES2 up until the real-time issue became less of a problem.)
            <p>
	    In addition to mobile apps, I did some experimentation on Microsoft Windows with large touchscreens, in this case
	    using OSC protocol rather than standard MIDI:
	    <iframe width="420" height="315" src="https://www.youtube.com/embed/QGCFZKSCR4A" frameborder="10"></iframe>	    
	</div>
	</div>

        <div class="sheet">
            <h2>Modal Quartertone Guitar Theory</h2>

            <div class=subsections>
                <div style="float:right">
                    <img src="instruments.jpg"/>
                </div>
                These diagrams give an idea of how quartertone modes work.
                This is loosely based on Maqam music theory (ie: Arabic/Turkish music).
                This system has a large variety of scales that are built of smaller chunks,
                and do not force alternation between major and minor tonalities.
                The use of quartertones gives a lot more scope for using minor tonalities in more places,
                along with some neutral ones.
                The theory I am laying out is however more oriented towards playing heavy metal on a quartertone guitar.

                <h3>Instruments</h3>
                <ul>
                    <li>Quartertone Electric - Reasonable approximations to Maqam can be played in a rock/metal context.
                        Pictured is a standard Stratocaster refretted for 24EDO (ie: 24 notes per octave, or doubled fretting).
                    <li>Fretless - Harder to fit in with standard instruments, but more true Maqam is playable .
                    <li>See <a href="http://www.maqamworld.com/">Maqam World</a> for a more standard treatment
                        of Maqam, including the microtonal details, and traditional features.  What I am documenting
                        is more oriented towards using 24EDO in a heavy metal context.
                    <li>The guys that actually built my quartertone guitar: <a href="http://www.metatonalmusic.com">Metatonal Music</a>
                </ul>
                <h3>Patterns</h3>
                <ul>
                    <li> keep in mind that fret numbers are <i>double</i> what they are on normal guitar.
                         conveniently, new strings start on multiples of 10, presuming it is tuned to all fourths as here.
                    <li> A small tone is the normal half tone in 12ET - <i>2 frets on quartertone guitar</i>
                    <li> A large tone is the normal whole tone in 12ET - <i>4 frets on quartertone guitar</i>
                    <li> A neutral tone is half-way in between small and large - <i>3 frets on a quartertone guitar</i>.
                    <li> It is almost always the case that neutral tones appear next to each other in pairs,
                         such that they span a minor third, and this minor third is on even frets to line up with 12EDO.
                    <li> In terms of frets: 0 4 6 is a "Minor" pattern, due to resembling bottom part of a minor scale. 
                    <li> In terms of frets: 0 2 6 is a "Phrygian" pattern, due to resembling bottom part of a phrygian scale. 
                    <li> In terms of frets: 0 3 6 is a "Bayati" pattern, due to having two neutral seconds right next to each other.
                </ul>
            </div>
        </div>
        <div class="sheet">
            <h2>Scale Diagrams</h2>
            <div class=subsections>
		All of these scale diagrams are JavaScript Canvas code (not static images).
		Feel free to grab the code out of this page to make microtonal fretboard diagrams, as the code is general enough to do this.

                <h3>Over Minor Pentatonics</h3>
                When starting out on the root note (E in this case),
                if we have a <i>Minor Pentatonic</i> backing scale, then we make it <i>Bayati</i> by adding note 1.
                Being neither <i>Phrygian (ie: Kurd)</i> nor <i>Minor (ie: Nahawand)</i>, choosing Bayati picks note 0 as the clear root.
                From note 0 to note 2, a minor third is being cut exactly in half; something impossible on a 12EDO instrument.
                It has two medium second intervals next to each other, noted as "MM":
                <p> 
                <canvas id="diagram1"></canvas>
                <p> 
                Compare with Minor
                <p> 
                <canvas id="diagram1A"></canvas>
                <p> 
                Compare with Phrygian
                <p> 
                <canvas id="diagram1B"></canvas>
                <p>
                As chord progressions change, the bottom half of the scales (tetrachords) define the
                notes in use.  Usually the scale isn't defined rigidly across the entire octave.
                The idea is to string together shorter partial scales.  In this way, many melodic
                runs will be full of accidentals, while still having a clear tonal character.
            </div>

          
            <div class=subsections> 
                <h3>Modulating</h3>
                As we move up, we can either do Phrygian on B, or use Bayati on B.  
                In this position, Bayati is picked.
                Note that it exhibits some symmetry with Bayati on E from notes 3 through 5.
                Note 4 is a quartertone flat from being a fifth above B (an F&#9839;), so it is clearly connected to E.
                <p>
                <canvas id="diagram2"></canvas>
            </div>

            <div class=subsections>
                <h3>Minor</h3>
                When modulating down to A, we pick the minor shaped scale.
                Because we are connecting to adjacent scales like Bayati on E and B, we probably want to preserve the B.
                It has large then small intervals, noted as "LS":
                <p>
                <canvas id="diagram3"></canvas>
            </div>
 
            <div class=subsections>
                Similarly, when modulating down to D, we pick the minor shaped scale.
                Because we want to preserve our minor third, we can make F natural.
                <p>
                <canvas id="diagram4"></canvas>
            </div>

            <div class=subsections>
                <h3>Phrygian</h3>
                We can visit Phrygian on E from D.
                It has small then large intervals, noted as "SL":
                <p>
                <canvas id="diagram5"></canvas>
            </div>

            <div class=subsections>
                <h3>Hijaz</h3>
                New scale shape Hijaz (Phrygian sharp third).  Note that the wide interval is a major third wide.
                It is so wide, that sometimes this major third might be cut in half into a pair of intervals.
                It could be: LS, SL, or MM.  Using MM would be like Bayati on F!
                <p>
                <canvas id="diagram6"></canvas>
            </div>

            <div class=subsections>
                <h3>Zamzama</h3>
                Following from this position on F - SLS
                <p>
                <canvas id="diagram7"></canvas>
                <p>
                Note that if rooted on note 1, it's the harmonic minor tetrachord.
            </div>

            <div class=subsections>
                <h3>Saba</h3>
                Following from this position on F - MMS
                <p>
                <canvas id="diagram8"></canvas>
            </div>

            <div class=subsections>
                <h3>Rast</h3>
                Rast is a comon major-like scale (more like Dorian quartersharp minor third).  
                The root note is 0, but there is strong emphasis on 1 and 4.
                If 1 were the center, it would be Bayati.
                Notice the pattern of notes creeping up one fret per string.
                This is useful for visualizing fretboard location
                <p>
                <canvas id="diagram9"></canvas>
                <p>
                Now, go to <a href="http://www.maqamworld.com/ajnas.html">Maqam World</a> and read about Ajnas</a>
            </div>
        </div>

        <div class="sheet">
            <h2>In Theory</h2>
            <div class=subsections>
                <h3>Generic Shape</h3>
                <p>
                <canvas id="diagram10"></canvas>
                <p>
                More generally, the pentatonic core is stable; and other notes tend to move around
                to suit the circumstances.
                Note that in none of this have you seen an actual quartertone (1 fret) interval.
                The harmonics on a string generally dictate where notes will lie, and there isn't
                a useful second interval much smaller than a half tone (2 fret - small step).
                <p>
                <canvas id="diagram10a"></canvas>
                <p>
                This is another generic shape that arises, which is roughly centered around a Rast tonality.
                This scale is practically impossible to resolve with non-quartertone instruments playing along though. 
            </div>

            <div class=subsections>
                <h3>Harmonics</h3>
                The reasoning behind the importance of interval sizes has to do with harmonics.
                Harmonic 1 is the full string, 2 is octave, etc.
                The importance in the order: octave, fifth, fourth, maj third, min third are made obvious by harmonics up to  about 6.
                The more fine intervals get their importance from how well they evenly divide these intervals.
                This is why fret distances of 1 never appear in these scales.
                Small seconds intervals are somewhere from harmonic 18 to 15.
                Medium seconds intervals are somewhere from 13 to 11.
                Large seconds intervals are around 9 to 10.
                <p>
                <canvas id="diagram11"></canvas>
                <p>
                Notice that harmonic 5 is slightly flat of the nearby fret.
                This is why when playing a maj third interval between two strings, bend the bottom note
                up a little bit until the timbre of the chord cleans up (and the beating goes away).
                This narrows the distance between the two notes.
                <p>
                Similarly harmonic 6 is slightly sharp of the nearby fret.
                So when playing minor third intervals between two strings, bend the top note up
                a little bit until the timbre of the chord cleans up (again, eliminates beating).
                This stretches the distance between the two notes.
                <p>
                Other intervals like a semitone (ie: an E and F played together) can be made just by bending
                the F up a little bit to clean up the chord.  The locations of the harmonics make it clear
                what the pattern of adjustments for intervals is going to be.
            </div>
            <div class=subsections>
                <h3>53 Equal Temperment</h3>
                In books on Maqam, the topic of alternate equal temperments as landmarks
                comes up.  After 24 equal as a useful approximation (for notating notes especially),
                53 equal arises as a way to accurately reason about the microtonal details.
                (See Touma's book "Music Of The Arabs").
                <p>
                Maqam is closely tied to Pythagorean tuning, where scales can be roughly thought of as
                a span of perfect fifths.
                A span of 53 perfect fifths comes so close to closing into a circle, that as
                far as this drawing goes, it doesn't matter whether we literally draw a scale
                created by spanning 53 perfect fifths or using 53 equal temperment.
                See how well the more important harmonics line up with fret locations.
                <p>
                <canvas id="diagram12"></canvas>
                <p>
                The fret widths drawn were <b>automatically</b> generated based on how close they
                are in the perfect circle of fifths.
                Many instruments only include a subset of these frets, using a span of 22 fifths.
                That leaves a pattern where whole tones are cut into 9 equal parts, where
                whole tones (from fret 0 to fret 9, a pitch difference of 9/8) have no exact semitone.
                There is a semitone at either 4 or 5, for high or low semitones.
                Usually, the large semitone is used, as it more closely matches actual harmonics.
                When moving from note to note, there are temporary chords of a semitone going on.
                <p>
                In this system:
                <ul>
                  <li>A fifth is 31 frets
                  <li>A fourth is 22 frets (and is how we tune the strings to each other)
                  <li>A large whole tone is 9 frets, corresponding to 9/8 pitch.
                  <li>A small whole tone is 8 frets, corresponding to 10/9 pitch.
                  <li>The harmonic series says that a minor third is fret 14 for 6/5 pitch.
                  <li>But by perfect circle of fifths (ie: Pythagorean reasoning), a minor third is fret 13, corresponding to (4/3)^3 (ie: if you tune a guitar with harmonics E A D G, G will be (4/3)^3.
                  <li>Similarly, the choice of major third by harmonics pitch 5/4.  That matches fret 17 quite closely.  But by Pythagorean reasoning, this is two whole tones up to fret 18, reached by (3/2)^4.
                  <li>In both cases, the ratio 81/80 makes the difference between harmonics and Pythagorean reasoning.
                  <li>In spite of Maqam being strongly oriented around quartertone intervals, 
                      the best choice for a quartertone is 13/12.  In practice, 11/10 is
                      usually what is meant by a quartertone, but it doesn't quite match a 53et
                      fret.  Sometimes 12/11 is meant (in between 13/12 and 11/10), but it also
                      isn't quite accurately represented by a 53equal fret.  (It happens to be that
                      the 24et quartertone is basically a 12/11.)  In this case though,
                      if notes are notated in 53et with a qualification that the note is a little
                      low or high, there can be very little doubt as to exactly what pitch is implied.
                </ul>
                When reading ambiguous statements like, 
                "the major third of Ajam needs to be lowered a little bit to be more mellow",
                the reasoning behind it is much more obvious when the fretboard is at least
                thought of in terms of 53 equal temperment.  In that case, the idea is to make the
                major third match 5/4.
                <p>
                As a side-note about a common definition of "Sruti", a span of 22 perfect fifths 
                will cause a scale that is very close to 12et to arise; except every note other than
                the root and fifth will have a doubled partner very close by 
                (roughly distance 81/80 away).  Similarly, a span of 17 perfect fifths gives a
                Pythagorean intonation where sharps and flats are distinct, like split black keys.
                Then spanning only 12 gives the true Pythagorean piano tuning, with its wolf interval
                among an otherwise fantastic intonation.  Spanning 7 gives a purely intoned diatonic
                scale, and spanning 5 gives a purely intoned pentatonic scale.
                <p>
                <img src="sruti.jpg">
                <p>
                Using this diagram, you can calculate explicitly how to reach a 53et fret
                by navigating in terms of only fourths, fifths, maj third, min third.
                The given ratios are just the more obvious equivalent ratios at that location.
                The point of this diagram is to show
                that 12et is an approximation of this Sruti span of 22 perfect fifths.  And
                even though it's defined in terms of "3-limit" (pure fifths), it actually contains
                some "5-limit" (including Just Intonation thirds).  And finally, the 53 equal
                temperment encompasses them both.  To some degree, this whole system exists
                as a side-effect of people playing string instruments with the strings tuned
                fourths and fifths apart; where the 81/80 pitch drift depending on melodic path
                is an issue that must be explicitly dealt with.  12et simply equates these close
                note pairs to make them go away in theory, but this issue still exists physically
                in the sound; creating a tension between clean chorde timbre (ie: beating) versus
                having distinct instruments playing from the same pitch set.
                <p>
                Other equal temperments are possible.  For practical reasons, 31 equal temperment
                might be a reasonable upper limit for most fretted and keyed instruments.
                Just for the sake of completeness, I will include it here.
                It is well known for being a great choice for triads (major and minor chords).
                It also doesn't have the 81/80 problem, as it is theoretically derived from
                a Just circle of major thirds.
                But note that it's not a great fit for Pythagorean intervals, which is
                important to support in maqam.
		<p>
		The important pitch ratios are in <a href="sumOfSquaredFactorsJavaScriptRender.png">this (large) image</a> as an octave equivalent ratio oriented pitch wheel.

                <p>
                <canvas id="diagram13"></canvas>
                <p>
                
                <h3>Suggestions</h3>
                Based on this, materials and price issues aside, it may be ideal in a microtonal
                guitar (fretted or unfretted) to:
                <ul>
                  <li>For quartertone guitars, perhaps fret coloring or width should alternate for
                      even and odd frets.  Or maybe this should be part of the inlay pattern.
                      The Kamal Musallam Ibanez Oriental Series actually does this, though
                      it isn't fully quartertone fretted, even at the bottom of the neck.
                  <li>If a subset of 53 equal temperment can't be used, then perhaps fretless
                      necks should be inlaid with a 53 equal temperment pattern.  This pattern
                      should roughly look like the 53EDO diagram to make it easy to visually
                      count out the long fret jumps.  Playing an actual 53 equal temperment
                      guitar will require having a fretboard vision that quickly locates
                      wholetone, fourth, and fifth relationships.  GeoSynthesizer has such
                      a pattern, but that pattern relies on "flattening" out the distance
                      between frets so that lines can be drawn between strings that make it
                      easy to intuitively play Just Intonation chords even with comma drift happening.
                      (Comma drift is landing one fret off at the end of navigating a phrase
                      by pure pitch ratios.)
                </li>
                <img src="ibanez-additional-fret.jpg">
            </div>
        </div>

        <div class="sheet">
            <h2>Various Tutorials and Demos</h2>
            <div class=subsections>
                <iframe width="560" height="315" src="http://www.youtube.com/embed/neJK76Z6-6o" frameborder="0"></iframe>
                <p>
                <ul>
                  <li><a href="https://www.youtube.com/watch?v=4NBDSHiBIQA">Integrating with normal scales and harmony demo</a>
                  <li><a href="http://www.kamalmusallam.com/">Kamal Musallam - the Arabic Fusion guitarist that plays partially quartertone fretted Ibanez endorsed guitars</a>
                  <li><a href="https://www.youtube.com/watch?v=GcRKVCgaDFo">Um Kulthum - Daret El Ayam</a>.  This is a widely covered song (usually not the full 45 minutes!), 
                  so watch the variations of it on YouTube to get an idea of the wide variability of intonation.  It also follows the common pattern of starting off with a
                  normal 12et-like tuning that extends into more difficult intonation as things progress.
                </ul>
                There are more such videos at <a href="http://www.youtube.com/rrr00bb">YouTube</a>
            </div>
        </div>
    </body>
</html>
